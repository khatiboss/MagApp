@{
    ViewBag.Title = "Home Page";
}

<h2>Lista Carrelli</h2>

<table class="table table-hover">
    <thead>
        <tr>
            <th>Matricola</th>
            <th>Anno Arrivo</th>
            <th>Area Stock</th>
            <th>Locazione</th>
        </tr>
    </thead>
    <tbody data-bind="foreach:carrelli">
        <tr>
            <td>
                <span data-bind="text:$data.matricola"></span>
            </td>
            <td>
                <span data-bind="text:$data.annoArrivo"></span>
            </td>
            <td>
                <span data-bind="text:$data.areaStock"></span>
            </td>
            <td>
                <span data-bind="text:$data.locazione"></span>
            </td>
            <td>
                <button class="btn btn-primary" data-bind="click:$parent.loadExistingCarrello,visible:$parent.shouldShowButton" data-target="#existingCarrello" data-toggle="modal">Edit</button>
                <button class="btn btn-danger" data-bind="click:$parent.remove, visible :$parent.shouldShowButton">Delete</button>
            </td>
        </tr>
    </tbody>
</table>
<button class="btn btn-primary" data-bind="visible:shouldShowButton,click:creatNewCarrello" data-target="#newCarrello" data-toggle="modal">New</button>
<div class="modal" id="newCarrello" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <div class="modal-title">
                    <strong>Nuovo Carrello</strong>
                </div>
            </div>
            <div class="modal-body" data-bind="with:newcarrello">
                <table cellpadding="10" width="100%">
                    <tr>
                        <td>
                            <strong>Matricola</strong>
                        </td>
                        <td>
                            <input type="text" name="matricola" data-bind="value:matricola" class="form-control nametxt" required />
                            <span class="validation-summary-errors" data-bind="text:$parent.modelState().matricolaErrors"></span>
                        </td>
                    </tr>
                <tr>
                    ..
                </tr>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default " data-dismiss="modal">Close</button>
                <button class="btn btn-primary" data-bind="click:save">Save</button>
            </div>
        </div>
    </div>
</div>

<div class="modal" id="existingCarrello" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <div class="modal-title">
                    <strong>Nuovo Carrello</strong>
                </div>
            </div>
            <div class="modal-body" data-bind="with:newcarrello">
                <table cellpadding="10" width="100%">
                    <tr>
                        <td>
                            <strong>Matricola</strong>
                        </td>
                        <td>
                            <input type="text" name="matricola" data-bind="value:matricola" class="form-control" required />
                            <span class="validation-summary-errors" data-bind="text:$parent.modelState().matricolaErrors"></span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <strong>Definition</strong>
                        </td>
                        <td>
                            ...
                        </td>
                    </tr>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button class="btn btn-primary" data-bind="click:update">Update</button>
            </div>
        </div>
    </div>
</div>
<script src="~/Scripts/jquery-3.3.1.min.js"></script>
<script src="~/Scripts/knockout-3.4.2.js"></script>
<script src="~/Scripts/App/ViewModels/carrelloViewModel.js"></script>
<script>
    $(document).ready(function () {
        var model = new carrelloViewModel();
        model.init();
        ko.applyBindings(model);
    });
</script>